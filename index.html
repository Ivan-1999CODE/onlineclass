<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ¯é€±å–®å­—ç‰¹è¨“ç­</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Poppins', 'Noto Sans TC', sans-serif;
            background-color: #F3F4F6;
            background-image: radial-gradient(#E5E7EB 1px, transparent 1px);
            background-size: 20px 20px;
            overscroll-behavior: none;
        }
        
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        .card-inner { transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); }

        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        #sidebar { transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        #sidebar-overlay { transition: opacity 0.3s ease-in-out; }

        .word-chip {
            transition: all 0.2s;
            cursor: pointer;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        .word-chip:active { transform: scale(0.95); }
        
        button { -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body class="min-h-[100dvh] flex items-center justify-center p-2 md:p-6 overflow-hidden">

    <!-- Main App Container -->
    <div class="w-full max-w-md md:max-w-lg lg:max-w-xl bg-white rounded-[2rem] shadow-2xl overflow-hidden border-4 border-white ring-1 ring-gray-100 flex flex-col h-[92dvh] md:h-[85vh] relative transform transition-all duration-300">
        
        <!-- Sidebar Overlay -->
        <div id="sidebar-overlay" onclick="toggleSidebar()" class="absolute inset-0 bg-black/40 backdrop-blur-[2px] z-40 hidden opacity-0 touch-none"></div>

        <!-- Sidebar -->
        <div id="sidebar" class="absolute top-0 left-0 w-72 h-full bg-white z-50 transform -translate-x-full shadow-2xl flex flex-col">
            <div class="p-6 bg-gradient-to-br from-violet-600 to-indigo-600 text-white shrink-0">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold flex items-center gap-2">
                        <i data-lucide="library" class="w-6 h-6"></i> èª²ç¨‹é¸å–®
                    </h2>
                    <button onclick="toggleSidebar()" class="p-1 hover:bg-white/20 rounded-full transition-colors">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                <p class="text-violet-100 text-sm">é¸æ“‡æ‚¨çš„å­¸ç¿’é€²åº¦</p>
            </div>
            <div class="flex-1 overflow-y-auto p-3 space-y-2">
                <button onclick="loadWeek(1)" class="w-full text-left p-4 rounded-xl hover:bg-violet-50 text-gray-700 font-medium transition-all flex justify-between items-center group active:scale-[0.98]" id="week-btn-1">
                    <span class="flex items-center gap-3"><span class="text-2xl">ğŸ“…</span> ç¬¬ä¸€é€±ï¼šåŸºç¤ç¯‡</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 text-gray-300 group-hover:text-violet-500"></i>
                </button>
                <button onclick="loadWeek(2)" class="w-full text-left p-4 rounded-xl hover:bg-violet-50 text-gray-700 font-medium transition-all flex justify-between items-center group active:scale-[0.98]" id="week-btn-2">
                    <span class="flex items-center gap-3"><span class="text-2xl">â„ï¸</span> ç¬¬äºŒé€±ï¼šå†¬æ—¥èˆ‡æ­·å²</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 text-gray-300 group-hover:text-violet-500"></i>
                </button>
                <button onclick="loadWeek(3)" class="w-full text-left p-4 rounded-xl hover:bg-violet-50 text-gray-700 font-medium transition-all flex justify-between items-center group active:scale-[0.98]" id="week-btn-3">
                    <span class="flex items-center gap-3"><span class="text-2xl">ğŸ¦†</span> ç¬¬ä¸‰é€±ï¼šåŸå¸‚èˆ‡è‡ªç„¶</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 text-gray-300 group-hover:text-violet-500"></i>
                </button>
                <button onclick="loadWeek(4)" class="w-full text-left p-4 rounded-xl hover:bg-violet-50 text-gray-700 font-medium transition-all flex justify-between items-center group active:scale-[0.98]" id="week-btn-4">
                    <span class="flex items-center gap-3"><span class="text-2xl">ğŸ”</span> ç¬¬å››é€±ï¼šé£²é£Ÿèˆ‡å¥å‹</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 text-gray-300 group-hover:text-violet-500"></i>
                </button>
                <button onclick="loadWeek(5)" class="w-full text-left p-4 rounded-xl hover:bg-violet-50 text-gray-700 font-medium transition-all flex justify-between items-center group active:scale-[0.98]" id="week-btn-5">
                    <span class="flex items-center gap-3"><span class="text-2xl">ğŸ•ï¸</span> ç¬¬äº”é€±ï¼šæˆ¶å¤–èˆ‡ä¼‘é–’</span>
                    <i data-lucide="chevron-right" class="w-4 h-4 text-gray-300 group-hover:text-violet-500"></i>
                </button>
            </div>
            <div class="p-4 border-t border-gray-100 text-center text-xs text-gray-400 bg-gray-50">
                Vocabulary App v5.0 (Grammar Enhanced)
            </div>
        </div>

        <!-- Header -->
        <div class="bg-gradient-to-r from-violet-500 to-fuchsia-500 pt-safe-top p-4 md:p-6 text-white text-center relative overflow-hidden shrink-0 z-10 shadow-md">
            <div class="absolute top-0 left-0 w-full h-full opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] pointer-events-none"></div>
            
            <div class="flex items-center justify-between relative z-10 mb-3">
                <button onclick="toggleSidebar()" class="p-2 -ml-2 rounded-xl hover:bg-white/20 active:bg-white/30 transition-colors">
                    <i data-lucide="menu" class="w-6 h-6 md:w-7 md:h-7 text-white"></i>
                </button>
                <h1 id="header-title" class="text-lg md:text-xl font-bold tracking-wide truncate px-2">Week 1</h1>
                <div class="w-10"></div>
            </div>
            
            <!-- Mode Switcher -->
            <div class="flex bg-black/10 p-1 rounded-2xl relative z-10 backdrop-blur-md gap-1 overflow-x-auto no-scrollbar snap-x">
                <button onclick="switchMode('study')" id="btn-study" class="snap-center flex-1 min-w-[70px] py-2.5 rounded-xl text-sm font-bold transition-all bg-white text-violet-600 shadow-sm whitespace-nowrap active:scale-95">
                    ğŸ“– è¤‡ç¿’
                </button>
                <button onclick="switchMode('sentence')" id="btn-sentence" class="snap-center flex-1 min-w-[70px] py-2.5 rounded-xl text-sm font-bold transition-all text-white hover:bg-white/10 whitespace-nowrap active:scale-95">
                    ğŸ§© å¥å‹
                </button>
                <button onclick="switchMode('quiz')" id="btn-quiz" class="snap-center flex-1 min-w-[70px] py-2.5 rounded-xl text-sm font-bold transition-all text-white hover:bg-white/10 whitespace-nowrap active:scale-95">
                    ğŸ¯ å–®å­—æ¸¬é©—
                </button>
                <button onclick="switchMode('grammar')" id="btn-grammar" class="snap-center flex-1 min-w-[70px] py-2.5 rounded-xl text-sm font-bold transition-all text-white hover:bg-white/10 whitespace-nowrap active:scale-95">
                    ğŸ“š æ–‡æ³•
                </button>
                <button onclick="switchMode('grammar-quiz')" id="btn-grammar-quiz" class="snap-center flex-1 min-w-[70px] py-2.5 rounded-xl text-sm font-bold transition-all text-white hover:bg-white/10 whitespace-nowrap active:scale-95">
                    ğŸ“ æ–‡æ³•æ¸¬é©—
                </button>
            </div>
        </div>

        <!-- Content Area -->
        <div class="p-4 md:p-8 flex-1 overflow-y-auto overflow-x-hidden relative bg-white scroll-smooth" id="content-area">
            
            <!-- VIEW: FLASHCARDS (STUDY) -->
            <div id="view-study" class="h-full flex flex-col relative max-w-md mx-auto w-full">
                
                <!-- View Toggle Switch -->
                <div class="flex justify-center mb-4 shrink-0">
                    <div class="bg-gray-100 p-1 rounded-xl flex shadow-inner">
                        <button onclick="setStudyView('card')" id="view-toggle-card" class="px-4 py-1.5 rounded-lg text-xs font-bold transition-all bg-white text-gray-800 shadow-sm flex items-center gap-1">
                            <i data-lucide="layers" class="w-3 h-3"></i> å¡ç‰‡
                        </button>
                        <button onclick="setStudyView('list')" id="view-toggle-list" class="px-4 py-1.5 rounded-lg text-xs font-bold transition-all text-gray-400 hover:text-gray-600 flex items-center gap-1">
                            <i data-lucide="list" class="w-3 h-3"></i> åˆ—è¡¨
                        </button>
                    </div>
                </div>

                <!-- MODE A: CARD VIEW -->
                <div id="study-mode-card" class="flex-1 flex flex-col justify-between h-full overflow-hidden transition-opacity duration-300">
                    <div class="text-center mb-2 text-gray-400 text-xs font-bold tracking-widest uppercase">
                        Card <span id="fc-counter" class="text-violet-600">1</span> of <span id="fc-total">30</span>
                    </div>

                    <!-- Flashcard -->
                    <div class="perspective-1000 w-full flex-1 min-h-[250px] md:min-h-[350px] cursor-pointer group mb-6 select-none tap-highlight-transparent" onclick="flipCard()">
                        <div id="flashcard-inner" class="card-inner relative w-full h-full transform-style-3d shadow-[0_8px_30px_rgb(0,0,0,0.08)] rounded-3xl">
                            
                            <!-- Front (English) -->
                            <div class="absolute w-full h-full backface-hidden bg-white border border-gray-100 rounded-3xl flex flex-col items-center justify-center p-8 bg-gradient-to-br from-white via-white to-violet-50/50">
                                <span id="fc-part" class="absolute top-6 right-6 bg-violet-100 text-violet-700 text-xs px-3 py-1 rounded-full font-bold uppercase tracking-wider">N.</span>
                                <h2 id="fc-en" class="text-4xl md:text-5xl font-bold text-gray-800 text-center mb-2 break-words leading-tight">Musician</h2>
                                <div class="mt-8 flex items-center gap-2 text-violet-400 text-sm animate-bounce">
                                    <i data-lucide="touchpad" class="w-4 h-4"></i>
                                    <span>é»æ“Šç¿»é¢</span>
                                </div>
                            </div>

                            <!-- Back (Chinese) -->
                            <div class="absolute w-full h-full backface-hidden rotate-y-180 bg-violet-600 text-white rounded-3xl flex flex-col items-center justify-center p-8 shadow-inner bg-[url('https://www.transparenttextures.com/patterns/stardust.png')]">
                                <h2 id="fc-zh" class="text-4xl md:text-5xl font-bold text-center break-words leading-tight">éŸ³æ¨‚å®¶</h2>
                            </div>
                        </div>
                    </div>

                    <!-- Controls -->
                    <div class="flex justify-between items-center gap-4 shrink-0 pb-2">
                        <button onclick="prevCard()" class="p-4 rounded-full bg-gray-50 hover:bg-gray-100 text-gray-600 transition-colors shadow-sm active:scale-90 border border-gray-100">
                            <i data-lucide="chevron-left" class="w-6 h-6"></i>
                        </button>
                        
                        <button onclick="speakWord()" class="flex-1 py-4 bg-violet-50 text-violet-600 rounded-2xl font-bold hover:bg-violet-100 transition-colors flex items-center justify-center gap-2 active:scale-[0.98]">
                            <i data-lucide="volume-2" class="w-5 h-5"></i>
                            <span>ç™¼éŸ³</span>
                        </button>

                        <button onclick="nextCard()" class="p-4 rounded-full bg-violet-600 hover:bg-violet-700 text-white transition-colors shadow-lg shadow-violet-200 active:scale-90 ring-4 ring-violet-50">
                            <i data-lucide="chevron-right" class="w-6 h-6"></i>
                        </button>
                    </div>
                </div>

                <!-- MODE B: LIST VIEW -->
                <div id="study-mode-list" class="hidden flex-1 overflow-y-auto px-1 pb-4 transition-opacity duration-300">
                    <!-- List items will be injected here -->
                    <div id="vocab-list-container" class="space-y-3"></div>
                </div>

            </div>

            <!-- VIEW: SENTENCE BUILDER -->
            <div id="view-sentence" class="hidden h-full flex flex-col max-w-lg mx-auto w-full">
                <div class="flex justify-between items-center mb-6">
                    <span class="text-sm font-bold text-gray-500 flex items-center gap-2">
                        <i data-lucide="puzzle" class="w-4 h-4"></i> é‡çµ„å¥å­
                    </span>
                    <span class="text-xs bg-violet-100 text-violet-700 px-3 py-1 rounded-full font-bold" id="sent-progress">1 / 5</span>
                </div>

                <!-- Chinese Hint -->
                <div class="bg-gradient-to-br from-gray-50 to-white p-6 rounded-2xl border border-gray-200 mb-6 text-center shadow-sm relative overflow-hidden shrink-0">
                    <div class="absolute top-0 left-0 w-1 h-full bg-violet-400"></div>
                    <p id="sent-zh" class="text-gray-800 font-bold text-xl md:text-2xl leading-relaxed">é€™ä½éŸ³æ¨‚å®¶æ­£åœ¨æ¼”å¥ã€‚</p>
                </div>

                <!-- Answer Area (Slots) -->
                <div id="sent-slots" class="flex flex-wrap gap-3 min-h-[100px] p-4 rounded-2xl bg-violet-50/30 border-2 border-dashed border-violet-200 items-start content-start mb-8 transition-colors duration-300 shrink-0">
                    <!-- Words move here -->
                </div>

                <!-- Word Bank -->
                <div class="flex-1 overflow-y-auto">
                    <p class="text-xs text-gray-400 mb-3 text-center uppercase tracking-widest font-bold">Word Bank</p>
                    <div id="sent-bank" class="flex flex-wrap gap-3 justify-center content-start pb-4">
                        <!-- Words start here -->
                    </div>
                </div>

                <!-- Result/Next Button -->
                <div class="mt-auto pt-4 flex items-center justify-center h-20 shrink-0">
                    <div id="sent-feedback" class="hidden w-full">
                        <button onclick="nextSentence()" class="w-full py-4 bg-green-500 text-white rounded-2xl font-bold shadow-lg shadow-green-200 hover:bg-green-600 active:scale-[0.98] transition-all flex items-center justify-center gap-2 text-lg animate-pulse">
                            <i data-lucide="check-circle-2" class="w-6 h-6"></i>
                            <span>æ­£ç¢ºï¼ä¸‹ä¸€é¡Œ</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- VIEW: QUIZ -->
            <div id="view-quiz" class="hidden h-full flex flex-col max-w-2xl mx-auto w-full">
                <!-- Score Header -->
                <div class="flex justify-between items-end mb-4 px-2 shrink-0">
                    <div class="flex flex-col">
                        <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">Score</span>
                        <span id="score-display" class="text-3xl font-black text-violet-600 leading-none">0</span>
                    </div>
                    <div class="flex flex-col items-end">
                         <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">Question</span>
                         <span class="text-xl font-bold text-gray-700"><span id="q-current">1</span>/<span id="q-total">10</span></span>
                    </div>
                </div>

                <!-- Timer Bar -->
                <div class="w-full bg-gray-200 rounded-full h-2.5 mb-6 overflow-hidden shrink-0">
                  <div id="timer-bar" class="bg-violet-500 h-2.5 rounded-full transition-all duration-100 ease-linear" style="width: 100%"></div>
                </div>

                <!-- Game Container -->
                <div id="quiz-game-container" class="flex-1 flex flex-col overflow-hidden">
                    <div class="bg-white border border-gray-100 rounded-3xl p-8 text-center shadow-[0_4px_20px_rgb(0,0,0,0.05)] mb-8 relative overflow-hidden shrink-0">
                        <div class="absolute top-0 inset-x-0 h-1 bg-gradient-to-r from-violet-400 via-fuchsia-400 to-violet-400"></div>
                        <span class="text-xs text-gray-400 uppercase tracking-widest font-bold">What is the meaning of?</span>
                        <h2 id="q-word" class="text-3xl md:text-4xl font-black text-gray-800 mt-3 mb-1">Word</h2>
                    </div>

                    <!-- Grid Layout -->
                    <div id="options-grid" class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4 overflow-y-auto pb-6 px-1">
                        <!-- Options injected here -->
                    </div>
                </div>

                <!-- Result Screen (Hidden by default) -->
                <div id="quiz-result-screen" class="hidden flex-1 flex-col items-center justify-center text-center pb-10">
                    <div class="w-24 h-24 bg-violet-100 rounded-full flex items-center justify-center mb-6 text-5xl">
                        ğŸ†
                    </div>
                    <h2 class="text-2xl font-bold text-gray-400 mb-2">Quiz Complete!</h2>
                    <h1 class="text-5xl font-black text-violet-600 mb-8" id="final-score">0</h1>
                    
                    <button onclick="startQuiz()" class="px-10 py-4 bg-violet-600 text-white rounded-full font-bold shadow-xl shadow-violet-200 hover:bg-violet-700 active:scale-95 transition-all text-lg flex items-center gap-2">
                        <i data-lucide="rotate-ccw" class="w-5 h-5"></i>
                        <span>å†ç©ä¸€æ¬¡</span>
                    </button>
                </div>

                <!-- Quiz Feedback Overlay -->
                <div id="feedback-overlay" class="absolute inset-0 bg-white/90 backdrop-blur-md z-20 hidden opacity-0 transition-opacity duration-300 flex flex-col items-center justify-center p-6 text-center">
                    <div id="feedback-icon" class="text-7xl mb-6 transform scale-0 transition-transform duration-300 drop-shadow-md">ğŸ‰</div>
                    <h3 id="feedback-text" class="text-3xl font-black text-gray-800 mb-6">Correct!</h3>
                    <!-- Feedback points added dynamically -->
                    <p id="feedback-points" class="text-xl font-bold text-violet-500 mb-6"></p>
                </div>
            </div>

            <!-- VIEW: GRAMMAR -->
            <div id="view-grammar" class="hidden h-full flex flex-col overflow-y-auto pb-4 max-w-2xl mx-auto w-full">
                <!-- Content injected via JS -->
            </div>

             <!-- VIEW: GRAMMAR QUIZ (STATICALLY RESTORED) -->
             <div id="view-grammar-quiz" class="hidden h-full flex flex-col max-w-2xl mx-auto w-full">
                <!-- Content Container (Explicitly present in HTML) -->
                <div id="g-quiz-content" class="flex flex-col h-full w-full">
                    <div class="flex justify-between items-center mb-6 shrink-0">
                        <span class="text-sm font-bold text-gray-500 flex items-center gap-2">
                            <i data-lucide="pencil" class="w-4 h-4"></i> æ–‡æ³•æ¸¬é©—
                        </span>
                        <span class="text-xs bg-violet-100 text-violet-700 px-3 py-1 rounded-full font-bold" id="g-quiz-progress">1 / 8</span>
                    </div>

                    <!-- Question Card -->
                    <div class="bg-white border border-gray-100 rounded-3xl p-6 md:p-8 shadow-[0_4px_20px_rgb(0,0,0,0.05)] mb-6 flex-1 flex flex-col relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-violet-400"></div>
                        
                        <!-- Scrollable Content Area: Removed justify-center to prevent clipping on mobile -->
                        <div class="flex-1 overflow-y-auto w-full flex flex-col">
                            <!-- mt-auto and mb-auto centers content but allows scroll if long -->
                            <div class="my-auto w-full">
                                <h2 id="g-quiz-q" class="text-2xl md:text-3xl font-bold text-gray-800 leading-relaxed mb-8 text-center px-2">
                                    Loading...
                                </h2>
                                
                                <!-- Options -->
                                <div id="g-quiz-options" class="grid grid-cols-1 gap-3 w-full max-w-md mx-auto">
                                    <!-- Options injected via JS -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="g-quiz-feedback" class="h-16 flex items-center justify-center text-center shrink-0">
                        <!-- Feedback msg -->
                    </div>
                </div>

                <!-- Empty State -->
                <div id="g-quiz-empty" class="hidden flex-col items-center justify-center h-full text-gray-400">
                    <i data-lucide="alert-circle" class="w-12 h-12 mb-2"></i>
                    <p>æœ¬é€±å°šç„¡æ–‡æ³•æ¸¬é©—</p>
                </div>
            </div>

        </div>
    </div>

<script>
    // Initialize Lucide Icons
    lucide.createIcons();

    // --- Data Repository ---
    const courseData = {
        1: {
            title: "Week 1: åŸºç¤ç¯‡",
            vocab: [
                { en: "music", zh: "éŸ³æ¨‚", part: "n." },
                { en: "lute", zh: "é­¯ç‰¹ç´", part: "n." },
                { en: "musician", zh: "éŸ³æ¨‚å®¶", part: "n." },
                { en: "country", zh: "åœ‹å®¶; åœ°å€", part: "n." },
                { en: "important", zh: "é‡è¦çš„", part: "adj." },
                { en: "cool", zh: "æ¶¼çˆ½çš„", part: "adj.", variants: "cooler, coolest" },
                { en: "holiday", zh: "å‡æœŸ", part: "n." },
                { en: "flight", zh: "èˆªç­; é£›è¡Œ", part: "n." },
                { en: "type", zh: "é¡å‹", part: "n." },
                { en: "prize", zh: "çé …; çè³", part: "n." },
                { en: "decide", zh: "æ±ºå®š", part: "v." },
                { en: "win", zh: "è´; ç²å‹", part: "v." },
                { en: "culture", zh: "æ–‡åŒ–", part: "n." },
                { en: "hot", zh: "ç†±çš„", part: "adj.", variants: "hotter, hottest" },
                { en: "planet", zh: "è¡Œæ˜Ÿ; åœ°çƒ", part: "n." },
                { en: "change", zh: "æ”¹è®Š; æ›´æ›", part: "v." },
                { en: "world", zh: "ä¸–ç•Œ", part: "n." },
                { en: "heat", zh: "ç†±åº¦; é«˜æº«", part: "n." },
                { en: "prefer", zh: "æ›´å–œæ­¡; åå¥½", part: "v." },
                { en: "love song", zh: "æƒ…æ­Œ", part: "n." },
                { en: "old", zh: "è€çš„", part: "adj.", variants: "older, oldest" },
                { en: "sad", zh: "å‚·å¿ƒçš„", part: "adj.", variants: "sadder, saddest" },
                { en: "perform", zh: "è¡¨æ¼”", part: "v." },
                { en: "barber", zh: "ç†é«®å¸«", part: "n." },
                { en: "competition", zh: "æ¯”è³½", part: "n." },
                { en: "design", zh: "è¨­è¨ˆ; åœ–æ¡ˆ", part: "n." },
                { en: "hair", zh: "é ­é«®; é«®å‹", part: "n." },
                { en: "realize", zh: "æ„è­˜åˆ°", part: "v." },
                { en: "animal", zh: "å‹•ç‰©", part: "n." },
                { en: "help", zh: "å¹«åŠ©", part: "v." },
                { en: "adopt", zh: "æ”¶é¤Š; é ˜é¤Š", part: "v." },
                { en: "problem", zh: "å•é¡Œ", part: "n." },
                { en: "dog", zh: "ç‹—", part: "n." }
            ],
            sentences: [
                { en: "The musician plays the lute", zh: "é€™ä½éŸ³æ¨‚å®¶æ¼”å¥é­¯ç‰¹ç´" },
                { en: "This is an important decision", zh: "é€™æ˜¯ä¸€å€‹é‡è¦çš„æ±ºå®š" },
                { en: "He wants to win the prize", zh: "ä»–æƒ³è¦è´å¾—é€™å€‹çé …" },
                { en: "The barber cuts hair", zh: "ç†é«®å¸«å‰ªé ­é«®" },
                { en: "I prefer pop music", zh: "æˆ‘æ¯”è¼ƒå–œæ­¡æµè¡ŒéŸ³æ¨‚" },
                { en: "It is the hottest day", zh: "é€™æ˜¯æœ€ç†±çš„ä¸€å¤©" },
                { en: "We live on a beautiful planet", zh: "æˆ‘å€‘ä½åœ¨ä¸€å€‹ç¾éº—çš„è¡Œæ˜Ÿä¸Š" },
                { en: "She won the competition", zh: "å¥¹è´å¾—äº†æ¯”è³½" },
                { en: "Do not be sad", zh: "ä¸è¦é›£é" },
                { en: "Culture is very important", zh: "æ–‡åŒ–éå¸¸é‡è¦" },
                { en: "They want to adopt a dog", zh: "ä»–å€‘æƒ³è¦é ˜é¤Šä¸€éš»ç‹—" }
            ],
            grammar: {
                title: "åŸºç¤å¥å‹è¤‡ç¿’",
                content: [
                    {
                        type: "rule",
                        title: "Be å‹•è© (am, is, are)",
                        desc: "ç”¨æ–¼æè¿°ç‹€æ…‹æˆ–èº«ä»½ã€‚",
                        examples: [
                            { en: "I am a musician.", zh: "æˆ‘æ˜¯ä¸€ä½éŸ³æ¨‚å®¶ã€‚" },
                            { en: "They are happy.", zh: "ä»–å€‘å¾ˆé–‹å¿ƒã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "help çš„ç”¨æ³•",
                        desc: "1. help + (to) V (å¹«åŠ©åšæŸäº‹)<br>2. help + with + N (åœ¨æŸæ–¹é¢å¹«å¿™)",
                        examples: [
                            { en: "She helps clean the house.", zh: "å¥¹å¹«å¿™æ‰“æƒæˆ¿å­ã€‚" },
                            { en: "He helps with the homework.", zh: "ä»–å¹«å¿™åšåŠŸèª²ã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "A be made of B",
                        desc: "è¡¨ç¤ºã€Œç”±...è£½æˆã€(ç‰©ç†è®ŠåŒ–ï¼Œä»å¯çœ‹å‡ºåŸææ–™)ã€‚",
                        examples: [
                            { en: "The table is made of wood.", zh: "é€™å¼µæ¡Œå­æ˜¯æœ¨é ­åšçš„ã€‚" },
                            { en: "The bottle is made of plastic.", zh: "é€™å€‹ç“¶å­æ˜¯å¡‘è† åšçš„ã€‚" }
                        ]
                    }
                ]
            },
            grammarQuiz: [
                {
                    q: "I ___ a musician.",
                    options: ["am", "is", "are", "be"],
                    answer: "am",
                    hint: "ç¬¬ä¸€äººç¨± I æ­é… amã€‚"
                },
                {
                    q: "The table is made ___ wood.",
                    options: ["from", "of", "by", "in"],
                    answer: "of",
                    hint: "be made of è¡¨ç¤ºç‰©ç†è®ŠåŒ–ï¼ˆçœ‹å¾—å‡ºåŸæ–™ï¼‰ã€‚"
                },
                {
                    q: "She helps ___ the homework.",
                    options: ["at", "on", "with", "to"],
                    answer: "with",
                    hint: "help with + åè© (help with the homework)ã€‚"
                },
                {
                    q: "He helps ___ the house.",
                    options: ["clean", "cleaning", "cleaned", "cleans"],
                    answer: "clean",
                    hint: "help + (to) åŸå½¢å‹•è©ã€‚"
                },
                {
                    q: "The boys ___ playing basketball.",
                    options: ["am", "is", "are", "be"],
                    answer: "are",
                    hint: "è¤‡æ•¸ä¸»è© (The boys) æ­é… areã€‚"
                },
                {
                    q: "This chair is made ___ plastic.",
                    options: ["by", "of", "from", "in"],
                    answer: "of",
                    hint: "be made of è¡¨ç¤ºç‰©ç†è®ŠåŒ–ã€‚"
                },
                {
                    q: "Can you help me ___ the door?",
                    options: ["open", "opening", "opened", "opens"],
                    answer: "open",
                    hint: "help + åŸå½¢å‹•è©ã€‚"
                },
                {
                    q: "She ___ my sister.",
                    options: ["are", "am", "is", "be"],
                    answer: "is",
                    hint: "ç¬¬ä¸‰äººç¨±å–®æ•¸ She æ­é… isã€‚"
                }
            ]
        },
        2: {
            title: "Week 2: å†¬æ—¥èˆ‡æ­·å²",
            vocab: [
                { en: "player", zh: "ç©å®¶; é¸æ‰‹", part: "n." },
                { en: "hit", zh: "æ‰“; æ’", part: "v." },
                { en: "point", zh: "é»; åˆ†", part: "n." },
                { en: "win", zh: "è´; ç²å‹", part: "v." },
                { en: "annoying", zh: "æƒ±äººçš„", part: "adj.", variants: "more annoying, most annoying" },
                { en: "fun", zh: "æœ‰è¶£çš„", part: "adj.", variants: "funner, funnest" },
                { en: "there was", zh: "æœ‰ (éå»å¼)", part: "phr." },
                { en: "a lot", zh: "å¾ˆå¤š", part: "phr." },
                { en: "snow", zh: "é›ª", part: "n." },
                { en: "team", zh: "åœ˜éšŠ", part: "n." },
                { en: "snowball fight", zh: "æ‰“é›ªä»—", part: "n." },
                { en: "jar", zh: "ç½å­", part: "n." },
                { en: "King", zh: "åœ‹ç‹", part: "Proper n." },
                { en: "wife", zh: "å¦»å­", part: "n." },
                { en: "Queen", zh: "çš‡å", part: "Proper n." },
                { en: "too much", zh: "å¤ªå¤š", part: "phr." },
                { en: "there is", zh: "æœ‰", part: "phr." },
                { en: "work", zh: "å·¥ä½œ; é‹è½‰", part: "v." },
                { en: "find", zh: "ç™¼ç¾; æ‰¾åˆ°", part: "v." },
                { en: "tomb", zh: "å¢“", part: "n." },
                { en: "water", zh: "æ°´", part: "n." },
                { en: "into", zh: "é€²å…¥", part: "prep." }
            ],
            sentences: [
                { en: "It was a fun snowball fight", zh: "é‚£æ˜¯ä¸€å ´æœ‰è¶£çš„æ‰“é›ªä»—" },
                { en: "The player wants to win", zh: "é‚£ä½é¸æ‰‹æƒ³è¦è´" },
                { en: "There was a lot of snow", zh: "é‚£è£¡æœ‰å¾ˆå¤šé›ª" },
                { en: "Our team got a point", zh: "æˆ‘å€‘çš„åœ˜éšŠå¾—äº†ä¸€åˆ†" },
                { en: "The sound is very annoying", zh: "é‚£å€‹è²éŸ³å¾ˆæƒ±äºº" },
                { en: "He hit the ball", zh: "ä»–æ“Šä¸­äº†çƒ" },
                { en: "Playing in the snow is fun", zh: "åœ¨é›ªä¸­ç©è€å¾ˆæœ‰è¶£" },
                { en: "The King and Queen are here", zh: "åœ‹ç‹å’Œçš‡ååœ¨é€™è£¡" },
                { en: "They found a jar in the tomb", zh: "ä»–å€‘åœ¨å¢“è£¡ç™¼ç¾äº†ä¸€å€‹ç½å­" },
                { en: "He goes to work every day", zh: "ä»–æ¯å¤©å»å·¥ä½œ" },
                { en: "There is too much water", zh: "æœ‰å¤ªå¤šçš„æ°´" },
                { en: "She went into the room", zh: "å¥¹èµ°é€²äº†æˆ¿é–“" }
            ],
            grammar: {
                title: "ç¾åœ¨ç°¡å–®å¼ï¼šå¦å®šå½¢å¼",
                subtitle: "Present Simple Negative",
                content: [
                    {
                        type: "rule",
                        title: "åŸºæœ¬å¥å¼",
                        desc: "Subject + don't / doesn't + Verb (Base Form)",
                        highlight: true,
                        examples: [
                            { en: "Things in the tomb don't look very good.", zh: "å¢“è£¡çš„æ±è¥¿çœ‹èµ·ä¾†ä¸å¤ªå¥½ã€‚" },
                            { en: "She doesn't like carrots.", zh: "å¥¹ä¸å–œæ­¡èƒ¡è˜¿è””ã€‚" },
                            { en: "We don't want your help.", zh: "æˆ‘å€‘ä¸æƒ³è¦ä½ çš„å¹«åŠ©ã€‚" }
                        ]
                    },
                    {
                        type: "table",
                        title: "åŠ©å‹•è©è¦å‰‡",
                        data: [
                            { sub: "I / You / We / They", aux: "don't (do not)" },
                            { sub: "He / She / It", aux: "doesn't (does not)" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "èƒ½ / ä¸èƒ½ (Can / Can't)",
                        desc: "æƒ…æ…‹åŠ©å‹•è©ï¼Œè¡¨ç¤ºèƒ½åŠ›æˆ–è¨±å¯ï¼Œå¾Œé¢æ¥åŸå½¢å‹•è©ã€‚",
                        examples: [
                            { en: "I can swim.", zh: "æˆ‘æœƒæ¸¸æ³³ã€‚" },
                            { en: "He can't drive.", zh: "ä»–ä¸æœƒé–‹è»Šã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "instead of (ä»£æ›¿ / è€Œä¸æ˜¯)",
                        desc: "å¾Œé¢æ¥åè© (N.) æˆ–å‹•åè© (V-ing)ã€‚",
                        examples: [
                            { en: "I want tea instead of coffee.", zh: "æˆ‘æƒ³è¦èŒ¶è€Œä¸æ˜¯å’–å•¡ã€‚" },
                            { en: "He walked instead of driving.", zh: "ä»–èµ°è·¯è€Œä¸æ˜¯é–‹è»Šã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "be careful with (å°å¿ƒ...)",
                        desc: "æé†’æŸäººå°å¿ƒè™•ç†æŸç‰©æˆ–æŸæƒ…æ³ã€‚",
                        examples: [
                            { en: "Be careful with that knife.", zh: "å°å¿ƒé‚£æŠŠåˆ€ã€‚" },
                            { en: "Please be careful with my glasses.", zh: "è«‹å°å¿ƒæˆ‘çš„çœ¼é¡ã€‚" }
                        ]
                    }
                ]
            },
            grammarQuiz: [
                {
                    q: "She ___ like carrots.",
                    options: ["don't", "doesn't", "isn't", "aren't"],
                    answer: "doesn't",
                    hint: "ç¬¬ä¸‰äººç¨±å–®æ•¸ (She) ä½¿ç”¨ doesn'tã€‚"
                },
                {
                    q: "I ___ swim very fast.",
                    options: ["cans", "can", "to can", "canning"],
                    answer: "can",
                    hint: "æƒ…æ…‹åŠ©å‹•è© can å¾Œé¢æ¥åŸå½¢å‹•è©ï¼Œä¸”ä¸éš¨äººç¨±è®ŠåŒ–ã€‚"
                },
                {
                    q: "I want tea instead ___ coffee.",
                    options: ["of", "for", "with", "to"],
                    answer: "of",
                    hint: "ç‰‡èª instead of (ä»£æ›¿)ã€‚"
                },
                {
                    q: "Please be careful ___ that knife.",
                    options: ["about", "of", "with", "at"],
                    answer: "with",
                    hint: "be careful with + ç‰©å“ã€‚"
                },
                {
                    q: "They ___ want to go.",
                    options: ["doesn't", "don't", "isn't", "aren't"],
                    answer: "don't",
                    hint: "è¤‡æ•¸ä¸»è© (They) çš„å¦å®šåŠ©å‹•è©ç”¨ don'tã€‚"
                },
                {
                    q: "___ you help me?",
                    options: ["Can", "Are", "Do", "Is"],
                    answer: "Can",
                    hint: "è¡¨ç¤ºè«‹æ±‚èƒ½åŠ›ï¼Œç”¨ Can é–‹é ­ã€‚"
                },
                {
                    q: "He went to the park instead of ___ at home.",
                    options: ["stay", "staying", "stayed", "to stay"],
                    answer: "staying",
                    hint: "instead of å¾Œé¢æ¥å‹•åè© (V-ing)ã€‚"
                },
                {
                    q: "Be careful ___ the hot water.",
                    options: ["at", "on", "with", "to"],
                    answer: "with",
                    hint: "be careful with + ç‰©å“ã€‚"
                }
            ]
        },
        3: {
            title: "Week 3: åŸå¸‚èˆ‡è‡ªç„¶",
            vocab: [
                { en: "there is", zh: "(åœ¨æŸå€‹åœ°æ–¹) æœ‰", part: "phr." },
                { en: "there are", zh: "æœ‰", part: "phr." },
                { en: "tradition", zh: "å‚³çµ±", part: "n." },
                { en: "duck", zh: "é´¨", part: "n." },
                { en: "field", zh: "å ´; å ´åœ°; é ˜åŸŸ", part: "n." },
                { en: "eat", zh: "åƒ; é£Ÿç”¨; æ¶ˆè€—", part: "v." },
                { en: "insect", zh: "æ˜†èŸ²", part: "n." },
                { en: "plant", zh: "æ¤ç‰©", part: "n." },
                { en: "for free", zh: "å…è²»", part: "phr." },
                { en: "farmer", zh: "è¾²æ°‘; è¾²å¤«", part: "n." },
                { en: "chemical", zh: "åŒ–å­¸ç‰©è³ª", part: "n." },
                { en: "thanks to", zh: "å¤šè™§äº†; ç”±æ–¼", part: "phr." },
                { en: "clean", zh: "æ¸…æ½”; æ¸…ç†", part: "v." },
                { en: "lots of", zh: "å¾ˆå¤š", part: "phr." },
                { en: "rice", zh: "ç™½ç±³; ç±³é£¯", part: "n." },
                { en: "photographer", zh: "æ”å½±å¸«", part: "n." },
                { en: "basketball", zh: "ç±ƒçƒ", part: "n." },
                { en: "court", zh: "çƒå ´", part: "n." },
                { en: "art gallery", zh: "ç•«å»Š; ç¾è¡“é¤¨", part: "n." },
                { en: "interested", zh: "æ„Ÿèˆˆè¶£çš„", part: "adj.", variants: "more interested" },
                { en: "look for", zh: "å°‹æ‰¾", part: "phr." },
                { en: "hundred", zh: "ç™¾", part: "num." },
                { en: "city", zh: "åŸå¸‚; å¸‚å€", part: "n." },
                { en: "between", zh: "ä¹‹...ä¹‹é–“", part: "prep." },
                { en: "building", zh: "å»ºç¯‰ç‰©", part: "n." },
                { en: "rooftop", zh: "å±‹é ‚", part: "n." },
                { en: "poetry", zh: "è©©è©", part: "n." },
                { en: "look like", zh: "çœ‹èµ·ä¾†åƒ", part: "phr." },
                { en: "century", zh: "ä¸–ç´€", part: "n." },
                { en: "creative", zh: "æœ‰å‰µé€ åŠ›çš„", part: "adj.", variants: "more creative" },
                { en: "meet", zh: "è¦‹é¢", part: "v." },
                { en: "talk", zh: "èªªè©±; è«‡è©±", part: "v." },
                { en: "poet", zh: "è©©äºº", part: "n." },
                { en: "poem", zh: "è©©", part: "n." },
                { en: "private", zh: "ç§äººçš„", part: "adj." },
                { en: "word", zh: "å–®å­—; æ–‡å­—", part: "n." },
                { en: "life", zh: "ç”Ÿå‘½", part: "n.", variants: "lives" },
                { en: "provide", zh: "æä¾›; ä¾›çµ¦", part: "v." },
                { en: "disappear", zh: "æ¶ˆå¤±; ä¸è¦‹", part: "v." },
                { en: "simple", zh: "ç°¡å–®çš„", part: "adj." },
                { en: "less", zh: "è¼ƒå°‘çš„; è¼ƒå°çš„", part: "adj." },
                { en: "borrow", zh: "å€Ÿå…¥; å€Ÿç”¨", part: "v." },
                { en: "careful", zh: "å°å¿ƒçš„; ä»”ç´°çš„", part: "adj." },
                { en: "forest", zh: "æ£®æ—", part: "n." },
                { en: "burn", zh: "ç‡ƒç‡’; ç‡’æ¯€", part: "v." },
                { en: "make sure", zh: "ç¢ºä¿; ç¢ºå®š", part: "phr." },
                { en: "plant", zh: "ç¨®æ¤", part: "v." },
                { en: "brothel", zh: "å¦“é™¢", part: "n." }
            ],
            sentences: [
                { en: "There is a duck in the field", zh: "ç”°è£¡æœ‰ä¸€éš»é´¨å­" },
                { en: "Thanks to the farmer we have rice", zh: "å¤šè™§äº†è¾²å¤«ï¼Œæˆ‘å€‘æœ‰ç±³é£¯" },
                { en: "He is interested in poetry", zh: "ä»–å°è©©è©æ„Ÿèˆˆè¶£" },
                { en: "The city looks like a picture", zh: "é€™åº§åŸå¸‚çœ‹èµ·ä¾†åƒä¸€å¹…ç•«" },
                { en: "There are lots of insects on the plant", zh: "æ¤ç‰©ä¸Šæœ‰å¾ˆå¤šæ˜†èŸ²" },
                { en: "The photographer is looking for a good shot", zh: "æ”å½±å¸«æ­£åœ¨å°‹æ‰¾ä¸€å€‹å¥½é¡é ­" },
                { en: "We met at the art gallery", zh: "æˆ‘å€‘åœ¨ç¾è¡“é¤¨è¦‹é¢" },
                { en: "There is a basketball court on the rooftop", zh: "å±‹é ‚ä¸Šæœ‰ä¸€å€‹ç±ƒçƒå ´" },
                { en: "This tradition is centuries old", zh: "é€™å€‹å‚³çµ±å·²ç¶“æœ‰å¹¾å€‹ä¸–ç´€äº†" },
                { en: "I want to talk to you in private", zh: "æˆ‘æƒ³ç§ä¸‹è·Ÿä½ è«‡è«‡" }
            ],
            grammar: {
                title: "Week 3 å¥å‹èˆ‡æ–‡æ³•",
                subtitle: "There is / Thanks to / Interested in / Can & Careful",
                content: [
                    {
                        type: "rule",
                        title: "There is / There are (æœ‰...å­˜åœ¨)",
                        desc: "ç”¨ä¾†è¡¨ç¤ºæŸå€‹åœ°æ–¹ã€Œæœ‰ã€äººæˆ–ç‰©ã€‚<br>There is + å–®æ•¸åè©<br>There are + è¤‡æ•¸åè©",
                        highlight: true,
                        examples: [
                            { en: "There is a duck in the field.", zh: "ç”°è£¡æœ‰ä¸€éš»é´¨å­ã€‚" },
                            { en: "There are lots of insects.", zh: "æœ‰å¾ˆå¤šæ˜†èŸ²ã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "Thanks to (å¤šè™§äº† / ç”±æ–¼)",
                        desc: "è¡¨ç¤ºåŸå› ï¼Œé€šå¸¸å¸¶æœ‰æ­£é¢çš„æ„Ÿæ¿€ä¹‹æ„ã€‚",
                        examples: [
                            { en: "Thanks to the rain, the plants grow well.", zh: "å¤šè™§äº†é€™å ´é›¨ï¼Œæ¤ç‰©é•·å¾—å¾ˆå¥½ã€‚" },
                            { en: "Thanks to your help, we finished.", zh: "å¤šè™§äº†ä½ çš„å¹«å¿™ï¼Œæˆ‘å€‘å®Œæˆäº†ã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "be interested in (å°...æ„Ÿèˆˆè¶£)",
                        desc: "ä¸»è©é€šå¸¸æ˜¯äººï¼Œå¾Œé¢æ¥åè©æˆ– V-ingã€‚",
                        examples: [
                            { en: "I am interested in art.", zh: "æˆ‘å°è—è¡“æ„Ÿèˆˆè¶£ã€‚" },
                            { en: "She is interested in learning English.", zh: "å¥¹å°å­¸è‹±æ–‡æ„Ÿèˆˆè¶£ã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "can/can't + Vr",
                        desc: "(ä¸) èƒ½å¤ ... ; (ä¸) å¯ä»¥... (è¡¨ç¤ºèƒ½åŠ›æˆ–è¨±å¯)",
                        examples: [
                            { en: "Ben can dance and play the guitar.", zh: "ç­æœƒè·³èˆè·Ÿå½ˆå‰ä»–ã€‚" },
                            { en: "You can't smoke here.", zh: "ä½ ä¸èƒ½åœ¨é€™è£¡æŠ½è¸ã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "instead of + N/Ving",
                        desc: "è€Œä¸æ˜¯ï¼›ä»£æ›¿",
                        examples: [
                            { en: "Maria ordered tea instead of coffee.", zh: "ç‘ªè‰äºé»çš„æ˜¯èŒ¶ï¼Œä¸æ˜¯å’–å•¡ã€‚" },
                            { en: "Instead of staying at home, Dad went swimming.", zh: "çˆ¸çˆ¸ä»Šå¤©æ—©ä¸Šæ²’æœ‰å¾…åœ¨å®¶ï¼Œä»–å»æ¸¸æ³³äº†ã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "be careful with ~",
                        desc: "ç•¶å¿ƒ... ï¼›æ³¨æ„...",
                        examples: [
                            { en: "Please be careful with my car.", zh: "è«‹å°å¿ƒæˆ‘çš„è»Šã€‚" },
                            { en: "David is careful with the baby.", zh: "å¤§è¡›å°å¿ƒç¿¼ç¿¼åœ°å°å¾…é‚£å¬°å…’ã€‚" }
                        ]
                    }
                ]
            },
            grammarQuiz: [
                {
                    q: "___ are lots of birds in the sky.",
                    options: ["There", "This", "That", "It"],
                    answer: "There",
                    hint: "There are + è¤‡æ•¸åè©ã€‚"
                },
                {
                    q: "She is interested ___ music.",
                    options: ["on", "at", "in", "with"],
                    answer: "in",
                    hint: "ç‰‡èª be interested inã€‚"
                },
                {
                    q: "Thanks ___ your help.",
                    options: ["for", "to", "at", "by"],
                    answer: "to",
                    hint: "ç‰‡èª Thanks to (å¤šè™§äº†)ã€‚"
                },
                {
                    q: "There ___ a book on the table.",
                    options: ["are", "am", "is", "be"],
                    answer: "is",
                    hint: "There is + å–®æ•¸åè© (a book)ã€‚"
                },
                {
                    q: "He is looking ___ his keys.",
                    options: ["at", "for", "to", "on"],
                    answer: "for",
                    hint: "look for (å°‹æ‰¾)ã€‚"
                },
                {
                    q: "___ to the nice weather, we can go out.",
                    options: ["Thank", "Thanks", "Thanking", "Thanked"],
                    answer: "Thanks",
                    hint: "Thanks to (å¤šè™§äº†)ã€‚"
                },
                {
                    q: "Ben ___ dance well.",
                    options: ["cans", "can", "to can", "canning"],
                    answer: "can",
                    hint: "æƒ…æ…‹åŠ©å‹•è© can å¾Œæ¥åŸå½¢å‹•è©ã€‚"
                },
                {
                    q: "He drank water instead ___ soda.",
                    options: ["of", "to", "for", "with"],
                    answer: "of",
                    hint: "instead of (è€Œä¸æ˜¯)ã€‚"
                },
                {
                    q: "Please be careful ___ the knife.",
                    options: ["at", "on", "with", "to"],
                    answer: "with",
                    hint: "be careful with + ç‰©å“ã€‚"
                }
            ]
        },
        // NEW WEEK 4
        4: {
            title: "Week 4: é£²é£Ÿèˆ‡ç”Ÿæ´»",
            vocab: [
                { en: "delicious", zh: "ç¾å‘³çš„", part: "adj." },
                { en: "hungry", zh: "é£¢é¤“çš„", part: "adj." },
                { en: "thirsty", zh: "å£æ¸´çš„", part: "adj." },
                { en: "restaurant", zh: "é¤å»³", part: "n." },
                { en: "menu", zh: "èœå–®", part: "n." },
                { en: "order", zh: "é»é¤; è¨‚è³¼", part: "v." },
                { en: "waiter", zh: "æœå‹™ç”Ÿ", part: "n." },
                { en: "favorite", zh: "æœ€å–œæ„›çš„", part: "adj." },
                { en: "noodle", zh: "éºµæ¢", part: "n." },
                { en: "soup", zh: "æ¹¯", part: "n." },
                { en: "market", zh: "å¸‚å ´", part: "n." },
                { en: "fresh", zh: "æ–°é®®çš„", part: "adj." },
                { en: "sweet", zh: "ç”œçš„", part: "adj." },
                { en: "sour", zh: "é…¸çš„", part: "adj." },
                { en: "taste", zh: "åšèµ·ä¾†; å‘³é“", part: "v./n." },
                { en: "kitchen", zh: "å»šæˆ¿", part: "n." },
                { en: "cook", zh: "çƒ¹é£ª; å»šå¸«", part: "v./n." },
                { en: "healthy", zh: "å¥åº·çš„", part: "adj." },
                { en: "vegetable", zh: "è”¬èœ", part: "n." },
                { en: "fruit", zh: "æ°´æœ", part: "n." },
                { en: "breakfast", zh: "æ—©é¤", part: "n." },
                { en: "lunch", zh: "åˆé¤", part: "n." },
                { en: "dinner", zh: "æ™šé¤", part: "n." },
                { en: "snack", zh: "é»å¿ƒ", part: "n." },
                { en: "drink", zh: "å–; é£²æ–™", part: "v./n." }
            ],
            sentences: [
                { en: "The food is delicious", zh: "é€™é£Ÿç‰©å¾ˆç¾å‘³" },
                { en: "I am very hungry", zh: "æˆ‘å¾ˆé¤“" },
                { en: "May I see the menu", zh: "æˆ‘å¯ä»¥çœ‹èœå–®å—" },
                { en: "She likes to cook dinner", zh: "å¥¹å–œæ­¡ç…®æ™šé¤" },
                { en: "This soup tastes sour", zh: "é€™æ¹¯åšèµ·ä¾†æ˜¯é…¸çš„" },
                { en: "They are eating at a restaurant", zh: "ä»–å€‘æ­£åœ¨é¤å»³åƒé£¯" },
                { en: "He wants to order noodles", zh: "ä»–æƒ³è¦é»éºµé£Ÿ" },
                { en: "Fresh fruit is healthy", zh: "æ–°é®®æ°´æœå¾ˆå¥åº·" },
                { en: "Do you want some water", zh: "ä½ æƒ³è¦ä¸€äº›æ°´å—" },
                { en: "My favorite snack is chocolate", zh: "æˆ‘æœ€æ„›çš„é»å¿ƒæ˜¯å·§å…‹åŠ›" }
            ],
            grammar: {
                title: "Week 4 é€²éšå¥å‹",
                subtitle: "å‹•åè© Ving / Other & Another / è¢«å‹•èªæ…‹",
                content: [
                    {
                        type: "rule",
                        title: "1. å‹•åè© (Ving)",
                        desc: "å°‡å‹•è© V åŠ  ingï¼Œç”¨ä¾†ä½œåè©ä½¿ç”¨ï¼ˆå¯ç•¶ä¸»è©æˆ–å—è©ï¼‰ã€‚",
                        highlight: true,
                        examples: [
                            { en: "Smoking is bad for your health.", zh: "æŠ½è¸å°ä½ çš„èº«é«”å¥åº·ä¸å¥½ã€‚" },
                            { en: "I love singing in the shower.", zh: "æˆ‘å–œæ­¡åœ¨æ´—æ¾¡æ·‹æµ´çš„æ™‚å€™å”±æ­Œã€‚" },
                            { en: "Eating ice cream makes me feel happy.", zh: "åƒå†°æ·‡æ·‹è®“æˆ‘æ„Ÿåˆ°é–‹å¿ƒã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "2. Other / Another / The Other",
                        desc: "â— other + è¤‡æ•¸ N (å…¶ä»–çš„...)<br>â— another + å–®æ•¸ N (å¦ä¸€å€‹ / å†ä¸€å€‹...)<br>â— the other (å‰©ä¸‹çš„å¦ä¸€å€‹)",
                        examples: [
                            { en: "I want to read other books.", zh: "æˆ‘æƒ³è¦è®€å…¶ä»–æ›¸ (other + è¤‡æ•¸)ã€‚" },
                            { en: "I want to read another book.", zh: "æˆ‘æƒ³è¦å†è®€ä¸€æœ¬æ›¸ (another + å–®æ•¸)ã€‚" },
                            { en: "Do you have other questions?", zh: "ä½ é‚„æœ‰å…¶ä»–çš„å•é¡Œå—ï¼Ÿ" },
                            { en: "May I ask another question?", zh: "æˆ‘å¯ä»¥å†å•å¦ä¸€å€‹å•é¡Œå—ï¼Ÿ" },
                            { en: "I have two pens. One is red, and the other is blue.", zh: "æˆ‘æœ‰å…©æ”¯ç­†ã€‚ä¸€æ”¯æ˜¯ç´…çš„ï¼Œå¦ä¸€æ”¯æ˜¯è—çš„ã€‚" }
                        ]
                    },
                     {
                        type: "rule",
                        title: "3. è¢«å‹•èªæ…‹ (be + p.p. + by)",
                        desc: "ä¸»è© + beå‹•è© + éå»åˆ†è© (p.p.) + by (è¢«...)",
                        examples: [
                            { en: "The book is written by Rowling.", zh: "é€™æœ¬æ›¸æ˜¯ç¾…ç³å¯«çš„ã€‚" },
                            { en: "These houses are built by Ross.", zh: "é€™äº›æˆ¿å­æ˜¯ç¾…æ–¯å»ºçš„ã€‚" },
                            { en: "I am bitten by the cat.", zh: "æˆ‘è¢«é‚£éš»è²“å’¬äº†ã€‚" }
                        ]
                    }
                ]
            },
            grammarQuiz: [
                // Gerunds
                {
                    q: "___ is bad for your health.",
                    options: ["Smoke", "Smoking", "Smoked", "Smokes"],
                    answer: "Smoking",
                    hint: "å‹•åè© (Ving) ç•¶ä¸»è©ã€‚"
                },
                {
                    q: "I love ___ in the shower.",
                    options: ["sing", "singing", "sings", "sang"],
                    answer: "singing",
                    hint: "Love å¾Œé¢æ¥å‹•åè© Vingã€‚"
                },
                {
                    q: "___ ice cream makes me happy.",
                    options: ["Eating", "Eat", "Ate", "Eats"],
                    answer: "Eating",
                    hint: "å‹•åè© (Ving) ç•¶ä¸»è©ã€‚"
                },
                {
                    q: "She enjoys ___ books.",
                    options: ["read", "reading", "reads", "to read"],
                    answer: "reading",
                    hint: "Enjoy å¾Œé¢æ¥ Vingã€‚"
                },
                {
                    q: "___ basketball is exciting.",
                    options: ["Play", "Played", "Playing", "Plays"],
                    answer: "Playing",
                    hint: "å‹•åè©ç•¶ä¸»è©ã€‚"
                },
                // Other / Another / The Other
                {
                    q: "I want to read ___ books.",
                    options: ["other", "another", "one", "others"],
                    answer: "other",
                    hint: "Books æ˜¯è¤‡æ•¸ï¼Œä½¿ç”¨ otherã€‚"
                },
                {
                    q: "I want to read ___ book.",
                    options: ["other", "another", "others", "the others"],
                    answer: "another",
                    hint: "Book æ˜¯å–®æ•¸ï¼Œä½¿ç”¨ anotherã€‚"
                },
                {
                    q: "Do you have ___ questions?",
                    options: ["another", "other", "one", "a"],
                    answer: "other",
                    hint: "Questions æ˜¯è¤‡æ•¸ï¼Œä½¿ç”¨ otherã€‚"
                },
                {
                    q: "May I ask ___ question?",
                    options: ["other", "another", "others", "few"],
                    answer: "another",
                    hint: "Question æ˜¯å–®æ•¸ï¼Œä½¿ç”¨ anotherã€‚"
                },
                {
                    q: "I have two cats. One is black, and ___ is white.",
                    options: ["another", "other", "the other", "others"],
                    answer: "the other",
                    hint: "å…©è€…ä¸­çš„å¦ä¸€å€‹ï¼Œä½¿ç”¨ the otherã€‚"
                },
                {
                    q: "I don't like this one. Show me ___ one.",
                    options: ["other", "another", "others", "the others"],
                    answer: "another",
                    hint: "å–®æ•¸åè© (one)ï¼Œä½¿ç”¨ anotherã€‚"
                },
                {
                    q: "There are ___ students in the classroom.",
                    options: ["another", "other", "one", "a"],
                    answer: "other",
                    hint: "Students æ˜¯è¤‡æ•¸ï¼Œä½¿ç”¨ otherã€‚"
                },
                // Passive Voice
                {
                    q: "The book is ___ by Rowling.",
                    options: ["write", "wrote", "written", "writing"],
                    answer: "written",
                    hint: "è¢«å‹•èªæ…‹ï¼šbe + p.p. (writeçš„ä¸‰æ…‹ï¼šwrite-wrote-written)ã€‚"
                },
                {
                    q: "These houses are ___ by Ross.",
                    options: ["build", "built", "building", "builds"],
                    answer: "built",
                    hint: "è¢«å‹•èªæ…‹ï¼šbe + p.p. (buildçš„ä¸‰æ…‹ï¼šbuild-built-built)ã€‚"
                },
                {
                    q: "I am ___ by the cat.",
                    options: ["bite", "bit", "bitten", "biting"],
                    answer: "bitten",
                    hint: "è¢«å‹•èªæ…‹ï¼šbe + p.p. (biteçš„ä¸‰æ…‹ï¼šbite-bit-bitten)ã€‚"
                },
                {
                    q: "The cake was ___ by him.",
                    options: ["eat", "ate", "eaten", "eating"],
                    answer: "eaten",
                    hint: "è¢«å‹•èªæ…‹ï¼šbe + p.p. (eatçš„ä¸‰æ…‹ï¼šeat-ate-eaten)ã€‚"
                },
                {
                    q: "English is ___ in many countries.",
                    options: ["speak", "spoke", "spoken", "speaking"],
                    answer: "spoken",
                    hint: "è¢«å‹•èªæ…‹ï¼šbe + p.p. (speakçš„ä¸‰æ…‹ï¼šspeak-spoke-spoken)ã€‚"
                },
                {
                    q: "The letter is ___ by Mary.",
                    options: ["send", "sent", "sending", "sends"],
                    answer: "sent",
                    hint: "è¢«å‹•èªæ…‹ï¼šbe + p.p. (sendçš„ä¸‰æ…‹ï¼šsend-sent-sent)ã€‚"
                },
                {
                    q: "The window was ___ yesterday.",
                    options: ["break", "broke", "broken", "breaking"],
                    answer: "broken",
                    hint: "è¢«å‹•èªæ…‹ï¼šbe + p.p. (breakçš„ä¸‰æ…‹ï¼šbreak-broke-broken)ã€‚"
                },
                {
                    q: "He wants to buy ___ car.",
                    options: ["other", "another", "others", "the others"],
                    answer: "another",
                    hint: "Car æ˜¯å–®æ•¸ï¼Œä½¿ç”¨ anotherã€‚"
                }
            ]
        },
        // NEW WEEK 5: Sports & Hobbies (Inferred from context and user constraint)
        5: {
            title: "Week 5: æˆ¶å¤–èˆ‡ä¼‘é–’",
            vocab: [
                { en: "badminton", zh: "ç¾½æ¯›çƒ", part: "n." },
                { en: "baseball", zh: "æ£’çƒ", part: "n." },
                { en: "basketball", zh: "ç±ƒçƒ", part: "n." },
                { en: "dodge ball", zh: "èº²é¿çƒ", part: "n." },
                { en: "tennis", zh: "ç¶²çƒ", part: "n." },
                { en: "soccer", zh: "è¶³çƒ", part: "n." },
                { en: "sport", zh: "é‹å‹•", part: "n." },
                { en: "player", zh: "é‹å‹•å“¡; é¸æ‰‹", part: "n." },
                { en: "gym", zh: "é«”è‚²é¤¨; å¥èº«æˆ¿", part: "n." },
                { en: "fan", zh: "ç‹‚ç†±æ„›å¥½è€…; ç²‰çµ²", part: "n." },
                { en: "team", zh: "éšŠä¼", part: "n." },
                { en: "game", zh: "æ¯”è³½; éŠæˆ²", part: "n." },
                { en: "race", zh: "è³½è·‘; æ¯”è³½", part: "n." },
                { en: "reporter", zh: "è¨˜è€…", part: "n." },
                { en: "lose", zh: "è¼¸", part: "v." },
                { en: "win", zh: "è´", part: "v." },
                { en: "practice", zh: "ç·´ç¿’", part: "v." }, // Removed "to"
                { en: "cheer", zh: "æ­¡å‘¼; åŠ æ²¹", part: "v." }, // Removed "to"
                { en: "join", zh: "åƒåŠ ", part: "v." }, // Removed "to"
                { en: "often", zh: "ç¶“å¸¸", part: "adv." },
                { en: "sometimes", zh: "æœ‰æ™‚å€™", part: "adv." },
                { en: "usually", zh: "é€šå¸¸", part: "adv." },
                { en: "always", zh: "ç¸½æ˜¯", part: "adv." },
                { en: "never", zh: "å¾ä¸", part: "adv." },
                { en: "once", zh: "ä¸€æ¬¡", part: "adv." },
                { en: "twice", zh: "å…©æ¬¡", part: "adv." },
                { en: "every", zh: "æ¯ä¸€å€‹", part: "adj." }
            ],
            sentences: [
                { en: "I often play baseball on weekends", zh: "æˆ‘ç¶“å¸¸åœ¨é€±æœ«æ‰“æ£’çƒ" },
                { en: "They practice soccer every day", zh: "ä»–å€‘æ¯å¤©ç·´ç¿’è¶³çƒ" },
                { en: "She wants to join the team", zh: "å¥¹æƒ³è¦åŠ å…¥é€™å€‹éšŠä¼" },
                { en: "The fans cheer for the players", zh: "ç²‰çµ²å€‘ç‚ºçƒå“¡åŠ æ²¹" },
                { en: "He never goes to the gym", zh: "ä»–å¾ä¸å»å¥èº«æˆ¿" },
                { en: "We play badminton twice a week", zh: "æˆ‘å€‘ä¸€é€±æ‰“å…©æ¬¡ç¾½æ¯›çƒ" },
                { en: "Winning the game is not easy", zh: "è´å¾—æ¯”è³½ä¸¦ä¸å®¹æ˜“" },
                { en: "Who is your favorite player", zh: "èª°æ˜¯ä½ æœ€å–œæ­¡çš„çƒå“¡" },
                { en: "I usually watch sports on TV", zh: "æˆ‘é€šå¸¸åœ¨é›»è¦–ä¸Šçœ‹é«”è‚²ç¯€ç›®" },
                { en: "Do you like playing dodge ball", zh: "ä½ å–œæ­¡æ‰“èº²é¿çƒå—" }
            ],
            grammar: {
                title: "Week 5 é »ç‡å‰¯è©",
                subtitle: "Frequency Adverbs / How often",
                content: [
                    {
                        type: "rule",
                        title: "1. é »ç‡å‰¯è©çš„ä½ç½®",
                        desc: "1. Be å‹•è©ä¹‹å¾Œ (be + é »ç‡)<br>2. ä¸€èˆ¬å‹•è©ä¹‹å‰ (é »ç‡ + V)<br>3. åŠ©å‹•è©ä¹‹å¾Œ (will/can + é »ç‡ + V)",
                        highlight: true,
                        examples: [
                            { en: "He is always late.", zh: "ä»–ç¸½æ˜¯é²åˆ° (be + always)ã€‚" },
                            { en: "I often play tennis.", zh: "æˆ‘ç¶“å¸¸æ‰“ç¶²çƒ (often + play)ã€‚" },
                            { en: "They usually eat dinner at 6.", zh: "ä»–å€‘é€šå¸¸åœ¨å…­é»åƒæ™šé¤ã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "2. How often è©¢å•é »ç‡",
                        desc: "ç”¨ä¾†è©¢å•åšæŸäº‹çš„é »ç‡æœ‰å¤šé«˜ã€‚",
                        examples: [
                            { en: "A: How often do you swim?", zh: "A: ä½ å¤šä¹…æ¸¸æ³³ä¸€æ¬¡ï¼Ÿ" },
                            { en: "B: I swim twice a week.", zh: "B: æˆ‘ä¸€é€±æ¸¸å…©æ¬¡ã€‚" },
                            { en: "Once a month / Three times a year", zh: "ä¸€å€‹æœˆä¸€æ¬¡ / ä¸€å¹´ä¸‰æ¬¡" }
                        ]
                    },
                    {
                        type: "table",
                        title: "é »ç‡ç¨‹åº¦è¡¨",
                        data: [
                            { sub: "Always", aux: "100% (ç¸½æ˜¯)" },
                            { sub: "Usually", aux: "80% (é€šå¸¸)" },
                            { sub: "Often", aux: "60% (ç¶“å¸¸)" },
                            { sub: "Sometimes", aux: "40% (æœ‰æ™‚å€™)" },
                            { sub: "Seldom", aux: "20% (å¾ˆå°‘)" },
                            { sub: "Never", aux: "0% (å¾ä¸)" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "3. Play çš„ç”¨æ³•æ¯”è¼ƒ",
                        desc: "â— play + çƒé¡é‹å‹• (ä¸åŠ  the)<br>â— play + the + æ¨‚å™¨ (è¦åŠ  the)",
                        highlight: true,
                        examples: [
                            { en: "I play soccer.", zh: "æˆ‘è¸¢è¶³çƒ (çƒé¡ä¸åŠ  the)ã€‚" },
                            { en: "She plays the piano.", zh: "å¥¹å½ˆé‹¼ç´ (æ¨‚å™¨è¦åŠ  the)ã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "4. Go + V-ing (å¾äº‹æ´»å‹•)",
                        desc: "ä½¿ç”¨ go æ¥å‹•åè©(V-ing)ï¼Œè¡¨ç¤ºå»å¾äº‹æŸç¨®é‹å‹•æˆ–ä¼‘é–’æ´»å‹•ã€‚",
                        examples: [
                            { en: "Let's go swimming.", zh: "æˆ‘å€‘å»æ¸¸æ³³å§ã€‚" },
                            { en: "They go camping every summer.", zh: "ä»–å€‘æ¯å¹´å¤å¤©å»éœ²ç‡Ÿã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "5. Stop to V vs Stop Ving",
                        desc: "â— stop + to V (åœä¸‹ä¾†å»åšå¦ä¸€ä»¶äº‹)<br>â— stop + Ving (åœæ­¢æ­£åœ¨åšçš„å‹•ä½œ)",
                        highlight: true,
                        examples: [
                            { en: "He stopped to talk to me.", zh: "ä»–åœä¸‹(æ‰‹é‚Šçš„äº‹)ä¾†è·Ÿæˆ‘èªªè©±ã€‚" },
                            { en: "He stopped talking.", zh: "ä»–åœæ­¢èªªè©±(é–‰å˜´)ã€‚" }
                        ]
                    },
                    {
                        type: "rule",
                        title: "6. å½¢å®¹è©æ¯”è¼ƒç´š (Comparative)",
                        desc: "â— å–®éŸ³ç¯€å­—å°¾ + er (tall -> taller)<br>â— å­éŸ³+çŸ­æ¯éŸ³+å­éŸ³ -> é‡è¤‡å­—å°¾ + er (big -> bigger)<br>â— é•·éŸ³ç¯€(2éŸ³ç¯€ä»¥ä¸Š) -> more + adj (more beautiful)<br>â— ä¸è¦å‰‡è®ŠåŒ– (good -> better, bad -> worse)",
                        examples: [
                            { en: "She is taller than me.", zh: "å¥¹æ¯”æˆ‘é«˜ã€‚" },
                            { en: "This car is more expensive.", zh: "é€™è¼›è»Šæ¯”è¼ƒè²´ã€‚" },
                            { en: "The weather is getting better.", zh: "å¤©æ°£æ¼¸æ¼¸è®Šå¥½äº†ã€‚" }
                        ]
                    }
                ]
            },
            grammarQuiz: [
                {
                    q: "I ___ play basketball after school.",
                    options: ["often", "oftens", "to often", "often to"],
                    answer: "often",
                    hint: "é »ç‡å‰¯è©æ”¾åœ¨ä¸€èˆ¬å‹•è©(play)ä¹‹å‰ã€‚"
                },
                {
                    q: "She is ___ happy.",
                    options: ["always", "play", "do", "does"],
                    answer: "always",
                    hint: "é »ç‡å‰¯è©(always)æ”¾åœ¨Beå‹•è©(is)ä¹‹å¾Œã€‚"
                },
                {
                    q: "___ often do you practice?",
                    options: ["What", "How", "Who", "Where"],
                    answer: "How",
                    hint: "è©¢å•é »ç‡ä½¿ç”¨ How oftenã€‚"
                },
                {
                    q: "I go to the gym ___ a week.",
                    options: ["one", "once", "first", "ones"],
                    answer: "once",
                    hint: "ä¸€æ¬¡ (once)ã€‚"
                },
                {
                    q: "He ___ eats vegetables. He hates them.",
                    options: ["always", "usually", "often", "never"],
                    answer: "never",
                    hint: "å› ç‚ºä»–è¨å­è”¬èœï¼Œæ‰€ä»¥æ‡‰é¸ã€Œå¾ä¸ã€ã€‚"
                },
                {
                    q: "They ___ soccer on Sundays.",
                    options: ["plays", "play", "playing", "to play"],
                    answer: "play",
                    hint: "They æ˜¯è¤‡æ•¸ï¼Œå‹•è©ç”¨åŸå½¢ playã€‚"
                },
                {
                    q: "We play baseball three ___ a month.",
                    options: ["time", "times", "timing", "timed"],
                    answer: "times",
                    hint: "ä¸‰æ¬¡ (three times)ã€‚"
                },
                {
                    q: "Do you want to ___ the team?",
                    options: ["join", "joins", "joining", "joined"],
                    answer: "join",
                    hint: "want to å¾Œé¢æ¥åŸå½¢å‹•è©ã€‚"
                },
                {
                    q: "He plays ___ guitar very well.",
                    options: ["a", "the", "X", "an"],
                    answer: "the",
                    hint: "æ¨‚å™¨ (guitar) å‰é¢è¦åŠ  theã€‚"
                },
                {
                    q: "Let's go ___ this weekend.",
                    options: ["shop", "shopping", "shops", "to shop"],
                    answer: "shopping",
                    hint: "Go + V-ing è¡¨ç¤ºå»å¾äº‹æŸæ´»å‹•ã€‚"
                },
                {
                    q: "We play ___ baseball after school.",
                    options: ["the", "a", "X", "an"],
                    answer: "X",
                    hint: "çƒé¡é‹å‹• (baseball) å‰é¢ä¸åŠ å† è©ã€‚"
                },
                {
                    q: "Please stop ___ noise.",
                    options: ["make", "to make", "making", "makes"],
                    answer: "making",
                    hint: "Stop + Ving (åœæ­¢åšæŸäº‹)ã€‚"
                },
                {
                    q: "He stopped ___ some water.",
                    options: ["buy", "to buy", "buying", "bought"],
                    answer: "to buy",
                    hint: "Stop + to V (åœä¸‹ä¾†å»åšæŸäº‹)ã€‚"
                },
                {
                    q: "My grade is ___ than yours.",
                    options: ["good", "gooder", "better", "best"],
                    answer: "better",
                    hint: "Good çš„æ¯”è¼ƒç´šæ˜¯ä¸è¦å‰‡è®ŠåŒ– betterã€‚"
                },
                {
                    q: "This problem is ___ than that one.",
                    options: ["hard", "harder", "more hard", "hardest"],
                    answer: "harder",
                    hint: "å–®éŸ³ç¯€å½¢å®¹è© + erã€‚"
                },
                {
                    q: "She is ___ than her sister.",
                    options: ["beautiful", "beautifuler", "more beautiful", "most beautiful"],
                    answer: "more beautiful",
                    hint: "é•·éŸ³ç¯€å½¢å®¹è©å‰é¢åŠ  moreã€‚"
                }
            ]
        }
    };

    // --- State Management ---
    let currentWeek = 1;
    let vocabList = [];
    let sentenceList = [];
    let currentGrammar = null;
    let currentGrammarQuiz = [];
    
    let currentMode = 'study';
    let currentStudyView = 'card'; // 'card' or 'list'
    let currentIndex = 0;
    
    // Quiz State
    let score = 0;
    let streak = 0;
    let currentQuizItem = null;
    let quizTimer = null;
    let timeLeft = 10;
    const QUIZ_TOTAL_QUESTIONS = 10;
    const TIME_LIMIT = 10; // seconds
    let currentQuestionNum = 0;

    // Sentence State
    let currentSentIndex = 0;
    let currentSentWords = [];
    let placedWords = [];
    let availableBankWords = [];

    // Grammar Quiz State
    let currentGQuizIndex = 0;

    // --- Initialization ---
    function init() {
        loadWeek(1);
        // Fix for mobile height issues on initialization
        window.addEventListener('resize', () => {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        });
    }

    // --- Sidebar Logic ---
    window.toggleSidebar = function() {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');
        const isClosed = sidebar.classList.contains('-translate-x-full');

        if (isClosed) {
            sidebar.classList.remove('-translate-x-full');
            overlay.classList.remove('hidden', 'opacity-0');
            document.body.style.overflow = 'hidden'; // Lock body scroll
        } else {
            sidebar.classList.add('-translate-x-full');
            overlay.classList.add('opacity-0');
            setTimeout(() => overlay.classList.add('hidden'), 300);
            document.body.style.overflow = ''; // Unlock body scroll
        }
    }

    window.loadWeek = function(weekId) {
        currentWeek = weekId;
        const data = courseData[weekId];
        
        vocabList = JSON.parse(JSON.stringify(data.vocab));
        sentenceList = JSON.parse(JSON.stringify(data.sentences));
        currentGrammar = data.grammar;
        currentGrammarQuiz = data.grammarQuiz || [];
        
        document.getElementById('header-title').innerText = data.title;
        
        // Updated loop for Week 5
        [1, 2, 3, 4, 5].forEach(id => {
            const btn = document.getElementById(`week-btn-${id}`);
            if (btn) { // Safety check
                if(id === weekId) {
                    btn.classList.add('bg-violet-50', 'text-violet-700');
                    btn.classList.remove('text-gray-700');
                } else {
                    btn.classList.remove('bg-violet-50', 'text-violet-700');
                    btn.classList.add('text-gray-700');
                }
            }
        });

        // Reset State
        currentIndex = 0;
        currentSentIndex = 0;
        currentGQuizIndex = 0;
        // Don't reset score/quiz here, only when starting quiz mode or finishing
        updateStats();

        // Separate shuffle for Flashcards and Quiz to keep list view somewhat consistent (optional, but shuffling list view is better for learning)
        shuffle(vocabList);
        shuffle(sentenceList);

        // Update Views
        updateFlashcard();
        renderStudyList(); 
        if (currentMode === 'sentence') initSentenceLevel();
        if (currentMode === 'quiz') startQuiz(); // Auto start quiz when loading week if in quiz mode
        if (currentMode === 'grammar') renderGrammar();
        if (currentMode === 'grammar-quiz') initGrammarQuiz();

        const sidebar = document.getElementById('sidebar');
        if (!sidebar.classList.contains('-translate-x-full')) {
            toggleSidebar();
        }
    }

    // --- Mode Switching ---
    window.switchMode = function(mode) {
        currentMode = mode;
        const btns = ['btn-study', 'btn-sentence', 'btn-quiz', 'btn-grammar', 'btn-grammar-quiz'];
        const views = ['view-study', 'view-sentence', 'view-quiz', 'view-grammar', 'view-grammar-quiz'];

        btns.forEach(b => {
            const btn = document.getElementById(b);
            if (b === `btn-${mode}`) {
                btn.className = "snap-center flex-1 min-w-[70px] py-2.5 rounded-xl text-sm font-bold transition-all bg-white text-violet-600 shadow-sm whitespace-nowrap active:scale-95";
            } else {
                btn.className = "snap-center flex-1 min-w-[70px] py-2.5 rounded-xl text-sm font-bold transition-all text-white hover:bg-white/10 whitespace-nowrap active:scale-95";
            }
        });

        views.forEach(v => {
            document.getElementById(v).classList.add('hidden');
        });
        document.getElementById(`view-${mode}`).classList.remove('hidden');

        // Scroll content area to top
        document.getElementById('content-area').scrollTop = 0;

        if (mode === 'quiz') startQuiz(); // Start new quiz session
        if (mode === 'sentence') initSentenceLevel();
        if (mode === 'grammar') renderGrammar();
        if (mode === 'grammar-quiz') initGrammarQuiz();
    }

    // ==========================================
    // ğŸ“– STUDY MODE: Card vs List
    // ==========================================
    
    window.setStudyView = function(viewMode) {
        currentStudyView = viewMode;
        const cardView = document.getElementById('study-mode-card');
        const listView = document.getElementById('study-mode-list');
        const btnCard = document.getElementById('view-toggle-card');
        const btnList = document.getElementById('view-toggle-list');

        if (viewMode === 'card') {
            cardView.classList.remove('hidden');
            listView.classList.add('hidden');
            
            btnCard.className = "px-4 py-1.5 rounded-lg text-xs font-bold transition-all bg-white text-gray-800 shadow-sm flex items-center gap-1";
            btnList.className = "px-4 py-1.5 rounded-lg text-xs font-bold transition-all text-gray-400 hover:text-gray-600 flex items-center gap-1";
        } else {
            cardView.classList.add('hidden');
            listView.classList.remove('hidden');
            
            btnCard.className = "px-4 py-1.5 rounded-lg text-xs font-bold transition-all text-gray-400 hover:text-gray-600 flex items-center gap-1";
            btnList.className = "px-4 py-1.5 rounded-lg text-xs font-bold transition-all bg-white text-gray-800 shadow-sm flex items-center gap-1";
            
            renderStudyList();
        }
    }

    function renderStudyList() {
        const container = document.getElementById('vocab-list-container');
        container.innerHTML = '';

        if(vocabList.length === 0) {
            container.innerHTML = '<p class="text-center text-gray-400 py-10">No vocabulary loaded.</p>';
            return;
        }

        vocabList.forEach(item => {
            const el = document.createElement('div');
            el.className = "bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between group active:scale-[0.99] transition-all";
            el.onclick = () => speakText(item.en);
            
            let variantsHtml = '';
            if (item.variants) {
                variantsHtml = `<span class="text-xs text-gray-400 ml-2 font-normal">(${item.variants})</span>`;
            }

            el.innerHTML = `
                <div class="flex-1">
                    <div class="flex items-baseline gap-2 mb-1">
                        <h3 class="text-lg font-bold text-gray-800">${item.en}</h3>
                        <span class="text-xs font-bold text-violet-500 bg-violet-50 px-1.5 py-0.5 rounded">${item.part}</span>
                    </div>
                    <p class="text-gray-600 text-sm">${item.zh} ${variantsHtml}</p>
                </div>
                <button class="p-2 rounded-full text-violet-300 group-hover:bg-violet-50 group-hover:text-violet-600 transition-colors">
                    <i data-lucide="volume-2" class="w-5 h-5"></i>
                </button>
            `;
            container.appendChild(el);
        });
        
        lucide.createIcons();
    }


    // ==========================================
    // ğŸ“š GRAMMAR RENDERER
    // ==========================================
    function renderGrammar() {
        const container = document.getElementById('view-grammar');
        if(!currentGrammar) {
            container.innerHTML = `<div class="p-8 text-center text-gray-400">æœ¬é€±å°šç„¡æ–‡æ³•å…§å®¹</div>`;
            return;
        }

        let html = `
            <div class="mb-6 bg-violet-50 p-6 rounded-2xl border border-violet-100">
                <h2 class="text-2xl font-bold text-violet-800">${currentGrammar.title}</h2>
                ${currentGrammar.subtitle ? `<p class="text-violet-500 font-medium mt-1">${currentGrammar.subtitle}</p>` : ''}
            </div>
        `;

        currentGrammar.content.forEach(section => {
            if(section.type === 'rule') {
                html += `
                    <div class="mb-6 bg-white rounded-2xl border-l-4 border-violet-500 shadow-sm p-5 ring-1 ring-gray-100">
                        <h3 class="font-bold text-lg text-gray-800 mb-2 flex items-center gap-2">
                            <i data-lucide="book-open" class="w-4 h-4 text-violet-500"></i> ${section.title}
                        </h3>
                        ${section.desc ? `<p class="text-gray-600 mb-4 leading-relaxed ${section.highlight ? 'bg-amber-50 p-3 rounded-lg text-amber-800 font-mono text-sm border border-amber-100' : ''}">${section.desc}</p>` : ''}
                        
                        ${section.examples ? `
                            <div class="space-y-3 mt-4">
                                ${section.examples.map(ex => `
                                    <div class="cursor-pointer group hover:bg-gray-50 p-3 rounded-xl transition-colors border border-transparent hover:border-gray-100" onclick="speakText('${ex.en.replace(/'/g, "\\'")}')">
                                        <div class="flex items-start gap-3">
                                            <div class="mt-1 p-2 bg-violet-100 rounded-full text-violet-600 shrink-0 group-hover:bg-violet-200 transition-colors">
                                                <i data-lucide="volume-2" class="w-4 h-4"></i>
                                            </div>
                                            <div>
                                                <p class="text-gray-800 font-bold text-base md:text-lg group-hover:text-violet-700 transition-colors">${ex.en}</p>
                                                <p class="text-gray-400 text-sm">${ex.zh}</p>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            } else if (section.type === 'table') {
                html += `
                    <div class="mb-6 bg-white rounded-2xl shadow-sm overflow-hidden ring-1 ring-gray-100">
                        <div class="bg-gray-50 px-5 py-3 border-b border-gray-100">
                            <h3 class="font-bold text-gray-700 text-sm flex items-center gap-2">
                                <i data-lucide="table" class="w-4 h-4"></i> ${section.title}
                            </h3>
                        </div>
                        <div class="divide-y divide-gray-100">
                            ${section.data.map(row => `
                                <div class="flex p-4 text-base">
                                    <div class="w-1/2 font-medium text-gray-800">${row.sub}</div>
                                    <div class="w-1/2 text-violet-600 font-mono font-bold text-right">${row.aux}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
        });
        
        container.innerHTML = html;
        lucide.createIcons();
    }

    // ==========================================
    // ğŸ“ GRAMMAR QUIZ LOGIC (SIMPLIFIED & ROBUST)
    // ==========================================
    function initGrammarQuiz() {
        const container = document.getElementById('view-grammar-quiz');
        
        // 1. Check for fallback restoration (Only if desperately needed)
        // If the inner content is completely gone (innerHTML empty), restore it.
        // This is a safety net.
        if (!document.getElementById('g-quiz-content')) {
            container.innerHTML = `
                <div id="g-quiz-content" class="flex flex-col h-full w-full">
                    <div class="flex justify-between items-center mb-6 shrink-0">
                        <span class="text-sm font-bold text-gray-500 flex items-center gap-2">
                            <i data-lucide="pencil" class="w-4 h-4"></i> æ–‡æ³•æ¸¬é©—
                        </span>
                        <span class="text-xs bg-violet-100 text-violet-700 px-3 py-1 rounded-full font-bold" id="g-quiz-progress">1 / 8</span>
                    </div>

                    <div class="bg-white border border-gray-100 rounded-3xl p-6 md:p-8 shadow-[0_4px_20px_rgb(0,0,0,0.05)] mb-6 flex-1 flex flex-col relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-violet-400"></div>
                        <div class="flex-1 overflow-y-auto w-full flex flex-col">
                            <div class="my-auto w-full">
                                <h2 id="g-quiz-q" class="text-2xl md:text-3xl font-bold text-gray-800 leading-relaxed mb-8 text-center px-2">Loading...</h2>
                                <div id="g-quiz-options" class="grid grid-cols-1 gap-3 w-full max-w-md mx-auto"></div>
                            </div>
                        </div>
                    </div>
                    <div id="g-quiz-feedback" class="h-16 flex items-center justify-center text-center shrink-0"></div>
                </div>
                <div id="g-quiz-empty" class="hidden flex-col items-center justify-center h-full text-gray-400">
                    <i data-lucide="alert-circle" class="w-12 h-12 mb-2"></i>
                    <p>æœ¬é€±å°šç„¡æ–‡æ³•æ¸¬é©—</p>
                </div>
            `;
            lucide.createIcons();
        }

        const contentDiv = document.getElementById('g-quiz-content');
        const emptyDiv = document.getElementById('g-quiz-empty');

        if (!currentGrammarQuiz || currentGrammarQuiz.length === 0) {
            contentDiv.classList.add('hidden');
            emptyDiv.classList.remove('hidden');
            emptyDiv.classList.add('flex');
            return;
        }

        // Show Content
        contentDiv.classList.remove('hidden');
        emptyDiv.classList.add('hidden');
        emptyDiv.classList.remove('flex');

        currentGQuizIndex = 0;
        renderGrammarQuiz();
    }

    function renderGrammarQuiz() {
        const item = currentGrammarQuiz[currentGQuizIndex];
        // Safety check
        if(!item) return;

        document.getElementById('g-quiz-progress').innerText = `${currentGQuizIndex + 1} / ${currentGrammarQuiz.length}`;
        document.getElementById('g-quiz-q').innerText = item.q;
        
        // Reset Feedback
        document.getElementById('g-quiz-feedback').innerHTML = '';
        
        const optionsDiv = document.getElementById('g-quiz-options');
        optionsDiv.innerHTML = '';
        
        item.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = "w-full p-4 bg-gray-50 border-2 border-gray-100 rounded-xl text-gray-700 font-bold hover:bg-violet-50 hover:border-violet-200 transition-all active:scale-[0.98] text-left md:text-center";
            btn.innerText = opt;
            btn.onclick = () => checkGrammarAnswer(opt, item, btn);
            optionsDiv.appendChild(btn);
        });
    }

    function checkGrammarAnswer(selected, item, btn) {
        const feedbackDiv = document.getElementById('g-quiz-feedback');
        const optionsDiv = document.getElementById('g-quiz-options');
        
        // Disable all buttons
        const allBtns = optionsDiv.querySelectorAll('button');
        allBtns.forEach(b => b.disabled = true);

        if (selected === item.answer) {
            // Correct
            btn.classList.remove('bg-gray-50', 'border-gray-100', 'text-gray-700');
            btn.classList.add('bg-green-100', 'border-green-500', 'text-green-700');
            feedbackDiv.innerHTML = `<span class="text-green-600 font-bold flex items-center gap-2"><i data-lucide="check" class="w-5 h-5"></i> ç­”å°äº†ï¼</span>`;
            fireConfetti();
            
            setTimeout(() => {
                if (currentGQuizIndex < currentGrammarQuiz.length - 1) {
                    currentGQuizIndex++;
                    renderGrammarQuiz();
                } else {
                    feedbackDiv.innerHTML = `<span class="text-violet-600 font-bold">ğŸ‰ æ¸¬é©—å®Œæˆï¼å¤ªæ£’äº†ï¼</span>`;
                    // Reset or show completion screen
                    setTimeout(() => {
                        currentGQuizIndex = 0;
                        renderGrammarQuiz();
                    }, 3000);
                }
            }, 1500);

        } else {
            // Incorrect
            btn.classList.remove('bg-gray-50', 'border-gray-100', 'text-gray-700');
            btn.classList.add('bg-red-100', 'border-red-500', 'text-red-700');
            
            // Highlight correct answer
            allBtns.forEach(b => {
                if(b.innerText === item.answer) {
                    b.classList.add('bg-green-50', 'border-green-300', 'text-green-700');
                }
            });

            feedbackDiv.innerHTML = `
                <div class="flex flex-col items-center">
                    <span class="text-red-500 font-bold flex items-center gap-2 text-sm"><i data-lucide="x" class="w-4 h-4"></i> å†è©¦ä¸€æ¬¡</span>
                    ${item.hint ? `<span class="text-xs text-gray-500 mt-1">${item.hint}</span>` : ''}
                </div>
            `;
            
            // Allow retry after delay
            setTimeout(() => {
                 if (currentGQuizIndex < currentGrammarQuiz.length - 1) {
                    currentGQuizIndex++;
                    renderGrammarQuiz();
                } else {
                     feedbackDiv.innerHTML = `<span class="text-violet-600 font-bold">ğŸ‰ æ¸¬é©—å®Œæˆï¼</span>`;
                     setTimeout(() => {
                        currentGQuizIndex = 0;
                        renderGrammarQuiz();
                    }, 3000);
                }
            }, 2500);
        }
        lucide.createIcons();
    }


    window.speakText = function(text) {
        // Cancel existing speech to avoid overlap
        speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'en-US'; 
        speechSynthesis.speak(utterance);
    }

    // ==========================================
    // ğŸ“– FLASHCARD LOGIC
    // ==========================================
    function updateFlashcard() {
        if(vocabList.length === 0) return;
        const item = vocabList[currentIndex];
        const cardInner = document.getElementById('flashcard-inner');
        
        // Reset flip immediately
        cardInner.style.transform = 'rotateY(0deg)'; 

        // Delay content update slightly for smooth transition feel if was flipped
        setTimeout(() => {
            let displayEn = item.en;
            if(item.variants) displayEn += `<br><span class="text-lg font-normal text-gray-400 mt-2 block">${item.variants}</span>`;
            
            document.getElementById('fc-en').innerHTML = displayEn;
            document.getElementById('fc-zh').innerText = item.zh;
            document.getElementById('fc-part').innerText = item.part;
            document.getElementById('fc-counter').innerText = currentIndex + 1;
            document.getElementById('fc-total').innerText = vocabList.length;
        }, 200);
    }

    window.flipCard = function() {
        const cardInner = document.getElementById('flashcard-inner');
        const isFlipped = cardInner.style.transform === 'rotateY(180deg)';
        cardInner.style.transform = isFlipped ? 'rotateY(0deg)' : 'rotateY(180deg)';
    }

    window.nextCard = function() {
        currentIndex = (currentIndex + 1) % vocabList.length;
        updateFlashcard();
    }

    window.prevCard = function() {
        currentIndex = (currentIndex - 1 + vocabList.length) % vocabList.length;
        updateFlashcard();
    }

    window.speakWord = function(e) {
        // Prevent card flip if button clicked inside card area (though button is outside now)
        if(e) e.stopPropagation(); 
        
        if(vocabList.length === 0) return;
        const item = vocabList[currentIndex];
        
        speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(item.en);
        utterance.lang = 'en-US'; 
        speechSynthesis.speak(utterance);
    }

    // ==========================================
    // ğŸ§© SENTENCE BUILDER LOGIC
    // ==========================================
    function initSentenceLevel() {
        if(sentenceList.length === 0) return;
        currentSentIndex = 0;
        loadSentence();
    }

    function loadSentence() {
        const sentObj = sentenceList[currentSentIndex];
        document.getElementById('sent-zh').innerText = sentObj.zh;
        document.getElementById('sent-progress').innerText = `${currentSentIndex + 1} / ${sentenceList.length}`;
        document.getElementById('sent-feedback').classList.add('hidden');

        // Prepare words
        const words = sentObj.en.replace(/[.,]/g,"").split(/\s+/);
        currentSentWords = words; 
        
        availableBankWords = words.map((w, i) => ({ word: w, id: i }));
        shuffle(availableBankWords);
        placedWords = []; 

        renderSent();
    }

    function renderSent() {
        const slotsDiv = document.getElementById('sent-slots');
        const bankDiv = document.getElementById('sent-bank');
        slotsDiv.innerHTML = '';
        bankDiv.innerHTML = '';

        if (placedWords.length === 0) {
            slotsDiv.innerHTML = `<span class="text-violet-300 text-sm w-full text-center py-4 select-none pointer-events-none font-medium italic">é»æ“Šä¸‹æ–¹å–®å­—ä¾åºæ’åˆ—...</span>`;
        } else {
            placedWords.forEach((obj, idx) => {
                const chip = createChip(obj.word, 'bg-white text-violet-700 border-violet-200 hover:bg-red-50 hover:border-red-200 hover:text-red-500 shadow-sm', () => removeWord(idx));
                slotsDiv.appendChild(chip);
            });
        }

        availableBankWords.forEach((obj, idx) => {
            const chip = createChip(obj.word, 'bg-white border-gray-200 text-gray-700 hover:border-violet-400 hover:text-violet-600 shadow-sm active:bg-violet-50', () => pickWord(idx));
            bankDiv.appendChild(chip);
        });

        checkSentenceCompletion();
    }

    function createChip(text, classes, onClick) {
        const btn = document.createElement('div');
        btn.className = `word-chip px-4 py-2 md:px-5 md:py-3 rounded-xl font-bold border-2 text-lg md:text-xl ${classes}`;
        btn.innerText = text;
        btn.onclick = onClick;
        return btn;
    }

    function pickWord(bankIdx) {
        const item = availableBankWords.splice(bankIdx, 1)[0];
        placedWords.push(item);
        renderSent();
    }

    function removeWord(placedIdx) {
        const item = placedWords.splice(placedIdx, 1)[0];
        availableBankWords.push(item);
        renderSent();
    }

    function checkSentenceCompletion() {
        if (availableBankWords.length === 0) {
            const attempt = placedWords.map(o => o.word).join(" ");
            const target = currentSentWords.join(" ");
            
            if (attempt === target) {
                document.getElementById('sent-feedback').classList.remove('hidden');
                fireConfetti();
                speakText(attempt); // Auto speak correct sentence
            } else {
                const slots = document.getElementById('sent-slots');
                slots.classList.add('border-red-400', 'bg-red-50');
                if('vibrate' in navigator) navigator.vibrate(200); // Haptic feedback
                setTimeout(() => slots.classList.remove('border-red-400', 'bg-red-50'), 500);
            }
        }
    }

    window.nextSentence = function() {
        currentSentIndex = (currentSentIndex + 1) % sentenceList.length;
        loadSentence();
    }

    // ==========================================
    // ğŸ¯ QUIZ LOGIC (TIMED)
    // ==========================================
    
    window.startQuiz = function() {
        // Reset State
        score = 0;
        currentQuestionNum = 0;
        updateStats();
        
        // UI Handling
        document.getElementById('quiz-result-screen').classList.add('hidden');
        document.getElementById('quiz-game-container').classList.remove('hidden');
        document.getElementById('quiz-game-container').classList.add('flex', 'flex-col');
        
        nextQuestion();
    }

    window.nextQuestion = function() {
        if(vocabList.length === 0) return;
        
        // Stop previous timer if any
        if(quizTimer) clearInterval(quizTimer);

        // Check Round Limit
        if(currentQuestionNum >= QUIZ_TOTAL_QUESTIONS) {
            endQuiz();
            return;
        }

        currentQuestionNum++;
        document.getElementById('q-current').innerText = currentQuestionNum;
        document.getElementById('q-total').innerText = QUIZ_TOTAL_QUESTIONS;

        // Reset UI for new Question
        const overlay = document.getElementById('feedback-overlay');
        overlay.classList.add('hidden');
        overlay.classList.remove('flex');
        
        // Pick Random Word
        currentQuizItem = vocabList[Math.floor(Math.random() * vocabList.length)];
        document.getElementById('q-word').innerText = currentQuizItem.en;

        // Generate Options
        let options = [currentQuizItem];
        let pool = [...vocabList];
        
        if(pool.length < 4) {
             pool.push({zh: "è˜‹æœ"}, {zh: "é¦™è•‰"}, {zh: "è²“"});
        }

        while (options.length < 4) {
            let rand = pool[Math.floor(Math.random() * pool.length)];
            if (!options.some(o => o.zh === rand.zh)) options.push(rand);
        }
        shuffle(options);

        // Render Options
        const grid = document.getElementById('options-grid');
        grid.innerHTML = '';
        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = "w-full p-5 md:p-6 bg-white border-2 border-gray-100 rounded-2xl text-gray-600 font-bold hover:border-violet-400 hover:text-violet-600 hover:bg-violet-50 transition-all text-left shadow-sm active:scale-[0.98] text-lg md:text-xl flex items-center justify-between group";
            btn.innerHTML = `
                <span>${opt.zh}</span>
                <i data-lucide="circle" class="w-5 h-5 text-gray-200 group-hover:text-violet-300"></i>
            `;
            btn.onclick = () => checkAnswer(opt, btn);
            grid.appendChild(btn);
        });
        
        lucide.createIcons();

        // Start Timer
        startTimer();
    }

    function startTimer() {
        timeLeft = TIME_LIMIT;
        updateTimerBar();
        
        // Update every 100ms for smooth bar
        quizTimer = setInterval(() => {
            timeLeft -= 0.1;
            updateTimerBar();
            
            if (timeLeft <= 0) {
                clearInterval(quizTimer);
                handleTimeout();
            }
        }, 100);
    }

    function updateTimerBar() {
        const percentage = (timeLeft / TIME_LIMIT) * 100;
        const bar = document.getElementById('timer-bar');
        bar.style.width = `${percentage}%`;
        
        // Color change based on time
        if(percentage < 30) {
            bar.classList.remove('bg-violet-500', 'bg-yellow-400');
            bar.classList.add('bg-red-500');
        } else if(percentage < 60) {
            bar.classList.remove('bg-violet-500', 'bg-red-500');
            bar.classList.add('bg-yellow-400');
        } else {
            bar.classList.remove('bg-yellow-400', 'bg-red-500');
            bar.classList.add('bg-violet-500');
        }
    }

    function handleTimeout() {
        // Disable all buttons
        const grid = document.getElementById('options-grid');
        const buttons = grid.querySelectorAll('button');
        buttons.forEach(btn => {
            btn.disabled = true;
            if(btn.innerText.includes(currentQuizItem.zh)) {
                btn.classList.add('bg-green-50', 'border-green-500', 'text-green-700');
            }
        });

        // Show timeout feedback
        showFeedback(false, 0, true);
    }

    function checkAnswer(selected, btnElement) {
        clearInterval(quizTimer);
        
        const grid = document.getElementById('options-grid');
        const buttons = grid.querySelectorAll('button');
        buttons.forEach(b => b.disabled = true); // Prevent double click

        if (selected === currentQuizItem) {
            // Calculate Score based on timeLeft
            // Max 100 points. Formula: (timeLeft / 10) * 100
            // Example: 9s left -> 90 pts. 1s left -> 10 pts.
            // Minimum 10 pts for correct answer if > 0s
            let points = Math.ceil((timeLeft / TIME_LIMIT) * 100);
            if(points > 100) points = 100;
            if(points < 10) points = 10; 

            score += points;
            streak++;
            
            // UI
            btnElement.classList.remove('border-gray-100', 'text-gray-600');
            btnElement.classList.add('bg-green-50', 'border-green-500', 'text-green-700');
            btnElement.innerHTML = `
                <span>${selected.zh}</span>
                <i data-lucide="check-circle" class="w-5 h-5 text-green-600"></i>
            `;
            
            // fireConfetti(); // Removed per user request
            if('vibrate' in navigator) navigator.vibrate([100, 50, 100]);
            
            showFeedback(true, points);
        } else {
            streak = 0;
            // UI
            btnElement.classList.remove('border-gray-100', 'text-gray-600');
            btnElement.classList.add('bg-red-50', 'border-red-500', 'text-red-700');
            btnElement.innerHTML = `
                <span>${selected.zh}</span>
                <i data-lucide="x-circle" class="w-5 h-5 text-red-600"></i>
            `;
            
            // Highlight correct one
            buttons.forEach(btn => {
                if(btn.innerText.includes(currentQuizItem.zh)) {
                    btn.classList.add('bg-green-50', 'border-green-500', 'text-green-700');
                }
            });

            if('vibrate' in navigator) navigator.vibrate(300);
            showFeedback(false, 0);
        }
        lucide.createIcons();
        updateStats();
    }

    function showFeedback(isCorrect, points, isTimeout = false) {
        const overlay = document.getElementById('feedback-overlay');
        const icon = document.getElementById('feedback-icon');
        const text = document.getElementById('feedback-text');
        const ptsDisplay = document.getElementById('feedback-points');
        
        overlay.classList.remove('hidden');
        overlay.classList.add('flex');
        
        // Force reflow
        void overlay.offsetWidth;
        overlay.classList.remove('opacity-0');
        icon.classList.remove('scale-0');
        icon.classList.add('scale-100');

        if(isTimeout) {
            icon.innerText = "â°";
            text.innerText = "Time's Up!";
            text.className = "text-3xl font-black text-gray-800 mb-2";
            ptsDisplay.innerText = "+0 pts";
            ptsDisplay.className = "text-xl font-bold text-gray-400 mb-6";
        } else if (isCorrect) {
            icon.innerText = "ğŸ‰";
            text.innerText = "Correct!";
            text.className = "text-4xl font-black text-green-500 mb-2";
            ptsDisplay.innerText = `+${points} pts`;
            ptsDisplay.className = "text-xl font-bold text-green-600 mb-6";
        } else {
            icon.innerText = "ğŸ˜¢";
            text.innerHTML = `<span class="text-sm text-gray-400 font-normal block mb-2">The answer is</span>${currentQuizItem.zh}`;
            text.className = "text-3xl font-bold text-gray-800 mb-2";
            ptsDisplay.innerText = "+0 pts";
            ptsDisplay.className = "text-xl font-bold text-red-400 mb-6";
        }

        // Auto Advance
        setTimeout(() => {
            nextQuestion();
        }, 1500); // 1.5 seconds delay
    }

    function endQuiz() {
        document.getElementById('quiz-game-container').classList.add('hidden');
        document.getElementById('quiz-game-container').classList.remove('flex');
        
        const resultScreen = document.getElementById('quiz-result-screen');
        resultScreen.classList.remove('hidden');
        resultScreen.classList.add('flex');
        
        document.getElementById('final-score').innerText = score;
        fireConfetti();
    }

    function updateStats() {
        document.getElementById('score-display').innerText = score;
        // Don't show streak on results screen to keep UI clean, but keep tracking it
    }

    function fireConfetti() {
        if (typeof confetti !== 'undefined') {
            confetti({
                particleCount: 150,
                spread: 80,
                origin: { y: 0.6 },
                colors: ['#8B5CF6', '#F472B6', '#34D399', '#FBBF24'],
                disableForReducedMotion: true
            });
        }
    }

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    // Start
    init();

</script>
</body>
</html>
